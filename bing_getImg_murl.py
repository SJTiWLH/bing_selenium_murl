
import requests
from bs4 import BeautifulSoup
from hashlib import md5
import os
import re
import time
from urllib.parse import urljoin, urlparse
from selenium import webdriver


def download_images_from_url(url, save_dir="downloaded_images", max_images=None, delay=1,use_selenium=False):
    """从指定网页下载所有图片（专注于获取原图）"""
    if not os.path.exists(save_dir):
        os.makedirs(save_dir)

    try:
        if use_selenium:
            # 使用Selenium获取动态网页内容
            html_content = get_dynamic_page_content(url, 16,0.5)
            soup = BeautifulSoup(html_content, 'html.parser')

        else:
            # 发送请求获取网页内容（不使用Selenium）
            headers = {
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
                "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
                "Referer": "https://cn.bing.com/images/search"
            }
            response = requests.get(url, headers=headers, timeout=15)
            response.raise_for_status()  # 检查请求是否成功

            # 解析网页提取原图URL
            soup = BeautifulSoup(response.text, 'html.parser')

        soup_text = soup.prettify()
        # print(soup_text)
        original_img_urls = extract_original_image_urls(soup)

        print(f"找到 {len(original_img_urls)} 个原图URL")
        downloaded_count = 0
        for i, img_url in enumerate(original_img_urls, 1):
            if max_images and downloaded_count >= max_images:
                print(f"已达到最大下载数 {max_images}，停止下载")
                break

            # 质量筛选
            # if not is_high_quality(img_url):
            #     print(f"低质量图片，跳过: {img_url}")
            #     continue

            print(f"\n下载第 {i}/{len(original_img_urls)} 张原图: {img_url}")
            success = download_image(img_url, save_dir)
            if success:
                downloaded_count += 1

            # 控制请求间隔
            time.sleep(delay)

        print(f"\n下载完成，共保存 {downloaded_count} 张图片到 {save_dir} 文件夹")

    except requests.exceptions.RequestException as e:
        print(f"请求出错: {str(e)}")
    except Exception as e:
        print(f"爬取过程中出错: {str(e)}")

def get_dynamic_page_content(url,scroll_times,wait_time):
    """打开浏览器，滑动鼠标获取东动态资源，然后获取整体页面代码并返回"""
    # url：打开的网址。 scroll_times：滑动次数。 wait_time：滑动的时间间隔
    driver = webdriver.Chrome()
    driver.get(url)
    print(f"正在使用Selenium加载网页: {url}")
    time.sleep(2)
    for i in range(scroll_times):
        # 滚动到页面底部
        driver.execute_script("window.scrollTo(0, document.body.scrollHeight);")
        # print(f"正在滚动页面 {i + 1}/{scroll_times}")
        time.sleep(wait_time)  # 等待页面加载

    # 获取完整HTML
    html_content = driver.page_source

    return html_content


def extract_original_image_urls(soup):
    """从网页内容中提取原图URL（针对Bing图片搜索）"""
    original_urls = []
    soup_text = soup.prettify()
    # 方法1：从script标签中的JSON数据提取原图URL（优先级高）
    if 'murl' in soup_text or 'thumb' in soup_text:
        print("进入murl")
        # print(soup_text)
        # 使用正则表达式提取JSON中的原图URL
        # 匹配格式: "murl":"https://example.com/image.jpg"
        matches = re.findall(r'"murl":"(https://[^"]+)"', soup_text)
        # print(matches)
        for url in matches:
            # 处理转义字符
            url = url.replace('\\u0026', '&')
            original_urls.append(url)

    # 方法2：从img标签的data-src属性提取（备用）
    if not original_urls:
        print("没有发现murl")
        return
        for img in soup.find_all('img'):
            print(img)
            data_src = img.get('data-src') or img.get('src')
            if data_src and 'th.bing.com' not in data_src and data_src.startswith('http'):
                original_urls.append(data_src)

    # 去重
    return list(set(original_urls))


def is_high_quality(img_url):
    """检查图片是否为高质量（通过URL参数或Content-Length判断）"""
    # 通过URL参数判断（Bing图片通常包含尺寸信息）
    if 'w=1920' in img_url or 'h=1080' in img_url or 'q=90' in img_url:
        return True

    # 尝试预请求获取Content-Length
    try:
        response = requests.head(img_url, timeout=5, headers={
            "User-Agent": "Mozilla/5.0"
        })
        if response.status_code == 200:
            content_length = response.headers.get('Content-Length')
            if content_length and int(content_length) > 400 * 300:  # 大于300KB
                return True
    except:
        pass

    return False


def download_image(url, save_dir):
    """下载单张图片并使用MD5去重"""
    try:
        # 发送图片请求
        response = requests.get(url, stream=True, timeout=15,
                                headers={
                                    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",
                                    "Referer": "https://cn.bing.com/images/search"
                                })

        if response.status_code == 200:
            # 计算图片MD5值用于去重
            img_md5 = md5(response.content).hexdigest()

            # 获取文件扩展名
            url_path = urlparse(url).path
            ext = url_path.split('.')[-1].lower() if '.' in url_path else 'jpg'

            # 支持的图片格式
            valid_extensions = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp']
            if ext not in valid_extensions:
                ext = 'jpg'  # 默认使用jpg格式

            # 生成唯一文件名
            file_name = f"{img_md5}.{ext}"
            file_path = os.path.join(save_dir, file_name)

            # 保存图片（仅当文件不存在时保存）
            if not os.path.exists(file_path):
                with open(file_path, 'wb') as f:
                    for chunk in response.iter_content(1024):
                        f.write(chunk)
                print(f"成功保存: {file_name}")
                return True
            else:
                print(f"图片已存在，跳过: {file_name}")
                return True
        else:
            print(f"图片请求失败，状态码: {response.status_code}")
            return False

    except Exception as e:
        print(f"下载图片时出错: {str(e)}")
        return False


if __name__ == "__main__":


    search_arr_s = {
   "力学实验器材": {
            # "电子天平（100g1000g）": ['电磁平衡式传感器天平（抗干扰型）', '全自动温度触发校准天平（实时补偿）',
            #                         '密度测定专用天平（浮力法计算）', '防静电常量天平（防粉尘干扰）',
            #                         '纺织专用电子天平（纱线张力校准）'],
            # "游标卡尺（125mm02mm）": ['深度测量游标卡尺（带深度杆）', '数显游标卡尺（0.01mm分辨率）',
            #                         '不锈钢防腐蚀卡尺（耐酸碱环境）', '尖爪型内径卡尺（测狭槽孔径）',
            #                         '带表盘游标卡尺（机械式读数）'],
            # "螺旋测微器（25mm01mm）": ['机械式千分尺（微分筒读数）', '数显千分尺（液晶屏直读）', '大砧面千分尺（曲面测量）',
            #                          '管材壁厚千分尺（圆砧设计）', '高温专用千分尺（隔热手柄）'],
            # "钢卷尺（5000mm）": ['自卷式钢卷尺（自动回弹）', '摇卷式钢卷尺（手摇柄收卷）', '耐磨涂层钢卷尺（抗磨损）',
            #                    '双面刻度钢卷尺（公制英制）', '磁吸端头钢卷尺（金属表面固定）'],
            # "弹簧测力计（5N10N）": ['平板式测力计（平面接触测量）', '圆盘式测力计（径向力检测）', '双向拉伸测力计（推拉两用）',
            #                       '教学演示测力计（透明外壳）', '高精度微力计（0.01N分辨率）'],
            # "力矩扳手": ['预设力矩扳手（可调阈值）', '指针指示式力矩扳手（表盘读数）', '数显力矩扳手（数字显示）',
            #              '预置式力矩扳手（固定扭矩值）', '套筒适配力矩扳手（多接口）'],
            # "滑轮组（定滑轮动滑轮）": ['单轮定滑轮（转向省力）', '复合滑轮组（多轮组合）', '轴承减摩滑轮（低阻力）',
            #                          '磁性固定滑轮（金属表面安装）', '可锁止滑轮（位置固定）'],
            # "杠杆（等臂不等臂）": ['直臂杠杆（均匀力矩分布）', '曲臂杠杆（变力臂设计）', '可调支点杠杆（支点移动）',
            #                      '力矩平衡演示杠杆（配重槽）', '多功能杠杆支架（角度可调）'],
            # "气垫导轨（1200mm）": ['直线型气垫导轨（匀速运动研究）', '弧形气垫导轨（圆周运动实验）',
            #                      '磁悬浮气垫导轨（零摩擦模拟）', '可调倾角气垫导轨（斜面实验）',
            #                      '多光电门气垫导轨（瞬时速度测量）'],
            # "小型气源（低噪音）": ['隔膜式气泵（无油静音）', '活塞式气泵（高压输出）', '微型真空泵（负压生成）',
            #                      '双头输出气泵（多设备供气）', '防震底座气泵（减振降噪）'],
            # "打点计时器（电磁式）": ['高压电磁打点器（20kV激励，低电压激活）', '光电同步打点器（触发联动，精准时间控制）',
            #                        '真空兼容打点器（低气压操作，消除空气阻尼）', '数字打点计数器（自动计点，数据直读）',
            #                        '低温环境打点计时器（-30℃适用，防冷凝设计）'],
            # "数字计时器（光电门接口）": ['时间间隔测定数字计时器（0.01ms分辨率，精密测量）',
            #                            '多通道数字计时器（8通道采集，并行处理）', '频率测量数字计时器（0.1Hz-100kHz范围）',
            #                            '触发延迟数字计时器（可编程延迟设置）',
            #                            '热稳定性数字计时器（±0.005%精度，温度补偿）'],
            # "自由落体实验仪": ['光控电磁释放装置（无机械延迟，快速响应）', '真空自由落体管（消除空气阻力，理想重力环境）',
            #                    '磁悬浮释放器（零摩擦启动，微重力模拟）', '带阻尼自由落体系统（空气阻力定量测量）',
            #                    '高速摄影集成装置（视觉轨迹捕捉，运动分析）'],
            # "牛顿第二定律演示仪": ['可变量力发生器（多级弹簧加载，力值精准调节）',
            #                        '加速度直接测定小车（集成传感器，实时反馈）',
            #                        '斜面变角度实验平台（角度连续调整，验证定律）',
            #                        '质量连续可调系统（滑动砝码设计，变量控制）',
            #                        '气垫导轨集成实验器（低摩擦界面，简化外力干扰）'],
            # "力的合成分解演示器": ['矢量角度精密控制台（0.1度分辨率，精准定向）',
            #                        '动态力平衡记录仪（实时图形分析，合力监测）', '三维空间合力分解模型（空间矢量合成研究）',
            #                        '滑轮组协作力合成装置（多绳索系统，变向分析）',
            #                        '磁力辅助力分解实验器（磁场无接触力加载）'],
            # "力矩盘（静力学平衡）": ['磁悬浮旋转力矩盘（无摩擦轴承，平衡测试）', '数字角度传感力矩盘（编码器读数，自动计算）',
            #                        '带刻度光学位移测量盘（激光定位，微距调整）',
            #                        '变直径半径适应盘（多杠杆固定点，杠杆原理验证）',
            #                        '热膨胀补偿力矩盘（温度稳定性材料，热力学补偿）'],
            # "测力传感器（1N分辨率）": ['S型双桥测力传感器（压缩拉伸两用，多向负载）',
            #                          '高温陶瓷测力传感器（1200℃适用，热稳定性）', '微型贴片测力传感器（PCB安装，微型化集成）',
            #                          '无线传输测力传感器（蓝牙数据，远程监控）', '防磁场干扰传感器（Mu金属屏蔽，电磁兼容）'],
            # "电子万能材料试验机（10kN-300kN）": ['微电脑控制材料试验机（图形界面，人机交互）',
            #                                    '高温箱集成材料试验机（室温~1000℃，热应变研究）',
            #                                    '低温材料试验机（-70℃测试，寒带材料分析）',
            #                                    '生物材料专用试验机（软组织夹具，生物力学）',
            #                                    '断裂韧性试验机（裂纹扩展分析，能量释放率）'],
            # "液压万能试验机（高负载测试）": ['数字显示液压试验机（触摸屏控制，高负载反馈）',
            #                                '大行程液压试验机（1米拉伸距离，长试样测试）',
            #                                '伺服控制高精度液压机（动态响应，闭环控制）',
            #                                '混凝土压缩液压试验机（重型柱塞，工程材料）',
            #                                '线材扭转液压复合试验机（复合加载模式）'],
            # "疲劳试验机（动态载荷模拟）": ['电液伺服疲劳试验机（正弦波加载，频率可调）',
            #                              '高频振动疲劳试验机（100Hz以上，快速疲劳测试）',
            #                              '恒振幅控制疲劳系统（振幅固定，寿命预测）',
            #                              '热机耦合疲劳试验机（温度循环，热应力影响）',
            #                              '多轴复杂载荷疲劳机（复合受力，多轴疲劳研究）'],
            # "冲击试验机（摆锤式）": ['数字化冲击试验机（能量自动计算，冲击值记录）', '低温冲击试样盒（液氮冷却，低温脆性测试）',
            #                        '高速摄像机集成冲击系统（断裂慢放，动态分析）',
            #                        '复合材料专用冲击机（小能量范围，层合板测试）',
            #                        '缺口自动定位冲击机（智能定位，减少误差）'],
            # "扭转试验机（扭矩测量）": ['扭转角精密记录系统（编码器反馈，角度量化）',
            #                          '微型样品扭转试验机（1Nm量程，微尺度扭矩）',
            #                          '高扭矩无级变速扭转机（1000Nm，重型轴类测试）',
            #                          '剪切蠕变扭转型（长时间测试，蠕变变形分析）',
            #                          '动态扭转疲劳试验系统（交变负载，扭振疲劳）'],
            # "蠕变试验机（高温持久测试）": ['多工位自动蠕变试验机（12试样并行，高效测试）',
            #                              '真空高温蠕变设备（无氧化环境，纯蠕变研究）',
            #                              '数据记录蠕变伸长仪（微米级测量，精度±0.1μm）',
            #                              '恒载荷精确蠕变控制系统（伺服电机，力值稳定）',
            #                              '石墨加热元高温蠕变炉（2000℃适用，超高温测试）'],
            # "硬度计（洛氏维氏布氏）": ['全自动数字硬度计（图像识别压痕，自动标定）',
            #                          '显微维氏硬度计（1gf最小测试力，微区硬度）', '便携式布氏硬度计（现场使用，快速测量）',
            #                          '金刚石锥头洛氏硬度计（硬化钢专用，高穿透力）',
            #                          '纳米压痕硬度计（划痕测试，纳米力学分析）'],
            # "摩擦试验机（干式湿式）": ['往复滑块摩擦试验机（线性运动，摩擦系数测定）',
            #                          '环块摩擦试验机（润滑油评估，磨损量检测）', '高温真空摩擦设备（环境控制，真空摩擦行为）',
            #                          '球盘式湿式摩擦试验机（磨耗测量，润滑状态）',
            #                          '微摩擦仪（纳米级摩擦力测试，微观界面研究）'],
            # "引伸计（微变形测量）": ['非接触式视频引伸计（光学跟踪，无损测量）', '高温陶瓷引伸计（1500℃适用，耐热变形）',
            #                        '线性可变差动变压器引伸计（LVDT型，高精度）', '光纤光栅引伸计（应变精确感知，分布式传感）',
            #                        '夹持式全自动引伸计（多点测量，自动夹持）'],
            # "加速度计（三轴向）": ['MEMS三轴加速度传感器（小型化，嵌入式设计）', '无线物联网加速度计（远程监控，云数据记录）',
            #                      '压电晶体高频加速度计（10kHz响应，瞬态冲击）',
            #                      '耐冲击高G值加速度计（1000g量程，强冲击记录）',
            #                      '温度补偿微振动加速度计（低频微振，补偿精度）'],
            # "振动测量仪（振幅频率分析）": ['激光多普勒振动仪（非接触扫描，全场振幅）',
            #                              'FFT频谱分析振动仪（实时带宽，频率响应）',
            #                              '分布式光纤振动监测系统（长距离，多点感知）',
            #                              '手持式机械结构振动分析仪（便携式，工业应用）',
            #                              '轴承振动专用诊断分析仪（故障模式识别）'],
            # "测振仪（压电效应设计）": ['压电陶瓷低频测振传感器（0.1Hz响应，稳态测量）',
            #                          '工业防爆环境测振仪（ATEX认证，危险区域）', '磁吸附多功能测振仪（磁力底座，快速安装）',
            #                          '声振动联合测试系统（噪声振动综合分析）', '相位共振测振定位仪（缺陷识别，相位差分析）'],
            # "动态力学分析仪（DMA）": ['多频率动态热机械分析仪（温控，频率扫描）', '弯曲模式薄膜DMA（柔性材料，薄膜粘弹性）',
            #                         '拉伸压缩复合加载DMA（多模式测试，材料响应）', '宽温度范围DMA（-150~600℃，温度依赖性）',
            #                         '变温频率扫描玻璃化转变测定DMA（相变点精确分析）'],
            # "弹性模量测试仪": ['激光干涉弹性模量仪（非接触全场应变）', '高温陶瓷弹性模量仪（1600℃氧化环境）',
            #                    '动态共振法弹性模量仪（音频频率扫描）', '微机电系统（MEMS）薄膜弹性模量测试台',
            #                    '各向异性材料弹性张量测量仪（多轴加载）'],
            # "扭力测试仪（静态动态）": ['高频动态扭力传感器（10kHz响应，瞬态扭矩）', '磁悬浮扭力校准仪（零摩擦基准）',
            #                          '生物关节仿生扭力测试台（模拟生理负载）', '微型转子扭力计（纳米扭矩分辨率）',
            #                          '高温螺纹紧固扭力分析仪（1000℃工况）'],
            # "频闪光源（25Hz-100Hz）": ['可编程多通道频闪光源（相位同步控制）', '高亮度LED频闪光源（0.1μs脉宽）',
            #                          '红外频闪光源（不可见光高速摄影）', '紫外激发频闪光源（荧光粒子追踪）',
            #                          '光纤耦合频闪光源（狭小空间集成）'],
            # "伽利略斜面装置": ['变曲率双轨道斜面（对比加速度）', '磁阻尼斜面（定量摩擦研究）', '光电计时斜面（多传感器同步）',
            #                    '真空环境斜面（无空气阻力）', '角度微调精密斜面（0.01°分辨率）'],
            # "滚摆（麦克斯韦摆）": ['电磁驱动滚摆（周期可编程控制）', '双摆轮干涉滚摆（振动模式分析）',
            #                      '真空滚摆（能量耗散定量）', '高精度光电编码滚摆（角速度实时反馈）',
            #                      '变惯量滚摆（可调配重块）'],
            # "碰撞实验仪（动量守恒验证）": ['磁悬浮碰撞台（零摩擦二维碰撞）', '高速粒子碰撞探测器（微尺度动量追踪）',
            #                              '多体碰撞分析仪（三维动量矢量化）', '弹性-塑性对比碰撞台（材料特性影响）',
            #                              '角动量守恒演示仪（旋转体碰撞）'],
            # "平抛运动实验器": ['气动发射平抛台（初速可控±0.01ms）', '激光网格落点定位仪（坐标自动标定）',
            #                    '真空平抛舱（无空气扰动）', '多目标同步平抛装置（对比轨迹）',
            #                    '高速摄影平抛集成系统（轨迹微分分析）'],
            # "向心力演示仪": ['无线力传感器向心力台（实时张力反馈）', '可变半径向心力臂（r-F关系验证）',
            #                  '离心率光学检测仪（偏心振动抑制）', '多质量体向心力比较架（ω同步控制）',
            #                  '磁驱无接触向心力发生器（无摩擦干扰）'],
            # "简谐振动实验装置": ['石英晶体微天平谐振器（纳米级振幅）', '磁阻尼可控振子（Q值调节）',
            #                      '光学杠杆放大谐振仪（微应变观测）', '耦合双振子实验台（模态分析）',
            #                      '真空环境谐振腔（无空气阻尼）'],
            # "弹簧振子（阻尼无阻尼）": ['电磁涡流阻尼振子（电控阻尼系数）', '光栅位移检测振子（0.1μm分辨率）',
            #                          '非线性弹簧振子（双刚度弹簧）', '真空磁悬浮弹簧振子（理想简谐振动）',
            #                          '多振子耦合共振仪（能量传递研究）'],
            # "流体力学实验槽": ['分层流实验水槽（密度梯度可视化）', '粒子图像测速槽（PIV兼容设计）',
            #                    '可变形底床水槽（泥沙输移模拟）', '旋转科里奥利力槽（地球物理流体模拟）',
            #                    '微流控芯片集成槽（微尺度流动）'],
            # "伯努利方程演示仪": ['翼型升力验证仪（压力分布孔阵列）', '文丘里-皮托管联用仪（压差-流速标定）',
            #                      '高速气流伯努利管（可压缩流拓展）', '粘性修正伯努利仪（层流阻力量化）',
            #                      '虹吸效应伯努利演示器（能量转换验证）'],
            "压力计（U型管数字式）": ['高精度硅压阻压力计（0.01%FS精度）', '高温熔体压力计（1600℃陶瓷传感器）',
                                    '微压差数字压力计（±10Pa量程）', '绝对真空基准压力计（10⁻⁶Pa校准）',
                                    '动态脉动压力计（1kHz采样）'],
            "流速计（涡轮式）": ['深井耐压涡轮流速计（100MPa防水）', '低扰动微型涡轮传感器（直径3mm）',
                               '高温燃气涡轮流速计（1200℃冷却结构）', '双向流涡轮计量仪（正反向流量识别）',
                               '磁驱无轴承涡轮仪（零摩擦损耗）'],
            "液压机（帕斯卡原理）": ['超高压液压发生器（1GPa静水压）', '透明可视化液压台（流线示踪）',
                                   '多活塞联动液压仪（压力放大演示）', '微流量液压伺服系统（μm级位移控制）',
                                   '智能液压闭环控制器（压力-流量解耦）'],
            "离心泵性能测试台": ['两相流离心泵测试台（气蚀特性分析）', '高转速轴承监测台（振动-效率关联）',
                                 '智能变频流量控制台（H-Q曲线自动测绘）', '耐腐蚀化工泵测试台（酸液循环系统）',
                                 '微型离心泵效率仪（μLmin级流量）'],
            "风洞（低速高速）": ['三维粒子追踪风洞（湍流结构解析）', '高超声速风洞（Ma=8激波管驱动）',
                               '环境边界层风洞（大气扩散模拟）', '结冰气候风洞（过冷水滴喷射）',
                               '微重力跌落式风洞（短时零重力环境）'],
            "雷诺实验装置（层流湍流观测）": ['高雷诺数透明管（Re10⁶可视化）', '微通道层流观测芯片（微米级流道）',
                                           '旋转泰勒-库埃特流装置（离心不稳定性）', '血液流变雷诺模拟器（非牛顿流体转换）',
                                           '温度梯度雷诺仪（热对流耦合效应）'],
            "表面张力测定仪": ['振荡滴动态表面张力仪（界面流变学）', '高温熔体表面张力仪（1600℃惰性气氛）',
                               '生物膜表面压测定仪（Langmuir水槽）', '微滴形貌分析仪（接触角同步测量）',
                               '磁悬浮界面张力仪（无接触测量）'],
            "粘度计（旋转式落球式）": ['高压毛细管粘度计（100MPa剪切率）', '微升样品旋转粘度计（生物样本适配）',
                                     '落球法高压粘度仪（超临界流体测试）', '振荡剪切流变仪（线性黏弹性区测量）',
                                     '高温玻璃熔体粘度计（软化点测定）'],
            "材料冲击韧性测试机": ['低温夏比冲击试验机（-196℃液氮环境）', '高速摄像冲击仪（裂纹扩展记录）',
                                   '多轴复合冲击台（复杂应力状态）', '生物材料冲击模拟器（仿生结构测试）',
                                   '辐射环境冲击腔（辐照脆化效应）'],
            "悬臂梁实验装置": ['光纤光栅应变梁（分布式载荷监测）', '磁激励共振梁（疲劳寿命预测）',
                               '微机电梁阵列（纳米尺度弯曲测试）', '高温氧化环境梁炉（材料耐久性）',
                               '智能材料自感知梁（压电形状记忆合金）'],
            "桁架结构加载仪": ['电动伺服加载桁架（多节点同步施力）', '失稳临界载荷测定仪（屈曲模态分析）',
                               '动态风载模拟桁架台（随机振动谱）', '空间可展开桁架测试仪（航天机构验证）',
                               '智能索桁架预应力控制器（索力实时调整）'],
            "复合材料力学测试机": ['编织复合材料各向异性测试机（多轴向加载）', '高温陶瓷基复合材料断裂仪（抗氧化涂层）',
                                   '层间剪切强度测试机（分层损伤监测）', '疲劳-蠕变复合试验机（时温等效加速）',
                                   '原位CT扫描复合材料台（内部损伤可视化）'],
            "生物力学拉伸仪（软组织测试）": ['细胞单轴拉伸仪（微牛顿力控）', '血管双向拉伸生物反应器（脉动流模拟）',
                                           '皮肤粘弹性拉伸仪（活体组织保持）', '肌腱疲劳拉伸台（生理循环载荷）',
                                           '仿生水凝胶拉伸槽（溶胀环境耦合）'],
            "岩石力学试验机（抗压强度）": ['三轴岩石压力室（围压100MPa）', '高温高压岩石流变仪（地壳条件模拟）',
                                         '声发射岩石破裂监测仪（微裂纹定位）', '水力压裂模拟试验台（裂隙网络分析）',
                                         '动态冲击岩石粉碎仪（钻探效率优化）'],
            "土壤直剪仪": ['非饱和土直剪仪（基质吸力控制）', '环剪仪（大变形剪切面）', '冻土直剪仪（-30℃低温剪切）',
                           '原位土体直剪模拟箱（原状样保持）', '动态剪切共振仪（剪切波速测量）'],
            "混凝土压力试验机": ['多通道微裂缝监测试验机（声发射阵列）', '徐变持久加载试验机（十年期数据记录）',
                                 '冲击后压缩试验机（CAI强度测试）', '高温混凝土爆裂试验炉（火灾行为模拟）',
                                 '智能骨料嵌入式测试机（压电传感器植入）'],
            "安全带强度测试仪": ['多姿态假人冲击测试台（碰撞姿态模拟）', '高低温环境安全带耐久仪（-40~85℃循环）',
                                 '织带蠕变松弛测试机（长期载荷保持）', '动态卷收力测试仪（紧急锁止响应分析）',
                                 '金属扣环疲劳试验机（万次开合寿命）'],
            "安全帽冲击试验机": ['穿刺-冲击复合试验机（穿透能量测量）', '低温耐撞性试验箱（-30℃预处理）',
                                 '多角度落锤冲击台（侧向顶部撞击）', '智能头模传感器阵列（压力分布测绘）',
                                 '紫外老化后冲击测试仪（材料退化影响）'],
            "钢丝绳拉力测试机": ['静载破断拉力测试机（极限承载力测定）', '动态疲劳拉力测试机（交变载荷寿命）',
                                 '高温蠕变拉力测试机（恒载持久变形）', '多股钢丝摩擦系数测试仪（股间滑移分析）',
                                 '腐蚀环境拉力测试舱（盐雾侵蚀耦合）'],
            "弹簧疲劳试验机": ['高频谐振式疲劳试验机（10kHz共振加载）', '变幅载荷程序控制试验机（载荷谱模拟）',
                               '高温弹簧松弛试验机（应力时效分析）', '多轴复合疲劳试验机（扭转-压缩耦合）',
                               '微动磨损疲劳试验机（接触面滑移效应）'],
            "螺栓扭矩校准仪": ['动态扭矩传感器校准台（旋转工况标定）', '预紧力衰减测量仪（螺纹摩擦损失量化）',
                               '高温螺栓应力松弛校准仪（热耦合效应）', '智能电动扳手标定系统（精度±0.5%）',
                               '法兰密封扭矩分布测量仪（多点同步监测）'],
            "齿轮磨损测试机": ['封闭功率流齿轮试验台（无负载能耗）', '微点蚀磨损分析仪（润滑油膜失效观测）',
                               '热胶合失效测试机（高速高温咬合）', '齿面修形磨损验证仪（接触斑优化分析）',
                               '纳米润滑涂层齿轮试验机（减摩涂层评估）'],
            "轴承寿命试验台": ['加速寿命试验台（过载工况寿命预测）', '杂质侵入磨损模拟舱（颗粒污染分析）',
                               '电蚀损伤试验机（电流通过效应）', '低温润滑失效试验台（-50℃工况）',
                               '智能振动诊断轴承台（故障频率识别）'],
            "万向节扭转刚度仪": ['动态交变扭角测试仪（相位滞后分析）', '十字轴微动磨损测量仪（关节接触应力）',
                                 '高温万向节松旷试验机（热膨胀间隙）', '多节万向节传动效率测试仪（角度损失量化）',
                                 '磁流变液万向节阻尼控制器（可变刚度）'],
            "皮带传动效率测试仪": ['滑差率精密测量仪（激光测速同步）', '带齿剪切疲劳试验机（同步带齿根断裂）',
                                   '环境温湿度影响测试舱（橡胶老化控制）', '多楔带侧向刚度测试仪（横向振动抑制）',
                                   '静电耗散皮带测试台（抗静电性能验证）'],
            "振动台（机械电动式）": ['多轴并联振动台（6自由度空间振动）', '高频液压振动台（2kHz以上响应）',
                                   '温度-振动复合试验箱（环境应力筛选）', '模态激振专用振动台（正弦扫频纯度99%）',
                                   '大位移低频振动台（地震波模拟）'],
            "模态分析系统（锤击法）": ['三维全场振型测量系统（激光扫描点云）', '高温结构模态分析仪（红外热像同步）',
                                     '微力传感器阵列锤头（0.1N分辨率）', '非线性模态识别系统（大变形振幅分析）',
                                     '旋转件工作模态分析仪（运行状态测试）'],
            "激光多普勒测振仪": ['显微激光测振系统（μm级微结构振动）', '高速三维振动扫描仪（50kHz采样率）',
                                 '高温表面非接触测振仪（1000℃耐火材料）', '水下声振耦合测量系统（液固界面波分析）',
                                 '纳米振幅干涉测振仪（0.1nm分辨率）'],
            "声发射检测仪（裂纹监测）": ['高频声发射传感器（1MHz带宽，裂纹扩展追踪）',
                                       '金属疲劳裂纹定位仪（时差定位精度±1mm）', '复合材料分层检测系统（模式识别算法）',
                                       '高温压力容器声发射仪（无线耐热传感器）', '轴承早期故障声发射仪（摩擦信号分离）'],
            "应变片（电阻式光纤式）": ['高温陶瓷基底应变片（1000℃抗氧化）', '微纳光纤光栅应变片（0.1με分辨率）',
                                     '防水动态应变片（水下结构监测）', '柔性可拉伸应变片（生物组织形变）',
                                     '抗电磁干扰应变片（强磁场环境应用）'],
            "静态电阻应变仪": ['多通道自动巡检应变仪（256通道同步）', '超低功耗无线应变仪（长期野外监测）',
                               '桥梁健康监测专用应变仪（自动温度补偿）', '混凝土固化收缩应变仪（早期徐变测量）',
                               '地基沉降分布式应变仪（光纤传感网络）'],
            "光弹性实验仪（应力可视化）": ['动态载荷光弹仪（应力波传播观测）', '三维冻结切片光弹仪（内部应力重构）',
                                         '高温光弹材料测试仪（热应力分布）', '数字相位偏移光弹仪（自动条纹分析）',
                                         '复合材料界面光弹仪（层间应力集中）'],
            "云纹干涉仪（位移场测量）": ['纳米云纹干涉仪（亚微米位移分辨率）', '高温变形云纹仪（热膨胀全场测量）',
                                       '微电子封装云纹仪（芯片热变形分析）', '振动模式云纹成像仪（瞬态位移捕捉）',
                                       '生物组织云纹仪（软组织大变形测量）'],
            "数字图像相关系统（DIC）": ['高速三维DIC系统（100,000fps采样）', '高温DIC专用标记涂料（1200℃不脱落）',
                                      '微尺度DIC系统（显微镜集成，视场1mm²）', '水下结构DIC测量舱（折射率校正）',
                                      '大视场桥梁DIC系统（50米距离测量）'],
            "高速摄像机（运动轨迹捕捉）": ['超高速分幅相机（1亿帧秒，爆炸过程）', '红外高速热像仪（温度-运动同步分析）',
                                         'X射线高速摄像机（金属内部运动可视化）', '多光谱同步高速相机（材料变形与温度场）',
                                         '粒子追踪测速专用相机（微流动示踪）'],
            "运动捕捉传感器（惯性测量单元）": ['微机电九轴IMU（加速度角速度磁融合）', '高G值抗冲击IMU（1000g耐受，弹道测试）',
                                             '水下惯性运动传感器（压力密封设计）', '肢体运动康复IMU（医疗级生物力学分析）',
                                             '航天器姿态确定IMU（微重力环境校准）'],
            "陀螺仪（角速度测量）": ['光纤陀螺仪（零机械转动部件）', 'MEMS振动陀螺仪（硅微结构共振）',
                                   '原子干涉陀螺仪（冷原子Sagnac效应）', '半球谐振陀螺仪（高稳定性航天导航）',
                                   '激光环形陀螺仪（无运动部件，耐冲击）'],
            "倾角仪（倾斜度检测）": ['双轴数字倾角仪（±90°全量程）', '动态倾角加速度计（运动补偿算法）',
                                   '地基沉降监测倾角仪（微弧度分辨率）', '工程机械安全倾角仪（翻车预警系统）',
                                   '卫星天线对准倾角仪（自动调平控制）'],
            "重心测定仪": ['三维动态重心跟踪仪（运动物体实时监测）', '飞行器配平重心仪（气动稳定性分析）',
                           '船舶稳心高度测量仪（倾覆力矩计算）', '微重力环境重心仪（空间站载荷适配）',
                           '多体系统等效重心仪（机械臂动力学）'],
            "转动惯量测试台": ['三线摆振动法测试台（无扭矩约束）', '扭摆法复合惯量测试台（偏置轴测量）',
                               '高速旋转体惯量仪（离心效应修正）', '微卫星惯量测试平台（真空环境模拟）',
                               '人体肢体段惯量测量仪（生物力学建模）'],
            "角加速度计": ['压电式高G值角加速度计（10,000rads²）', 'MEMS陀螺集成角加速度计（动态响应补偿）',
                           '光纤光栅角加速度传感器（抗电磁干扰）', '旋转机械振动角加速度计（轴系扭振分析）',
                           '弹体滚转角加速度计（制导系统反馈）'],
            "动量矩守恒演示器": ['可调转动惯量飞轮台（惯量-角速度反比）', '零重力动量轮演示仪（磁悬浮无摩擦）',
                                 '角动量矢量合成演示器（三维空间守恒）', '陀螺进动角动量仪（外力矩方向演示）',
                                 '人体转椅角动量仪（肢体伸展收缩实验）'],
            "科里奥利力实验装置": ['旋转流体对流演示仪（台风形成模拟）', '傅科摆改进型科氏力仪（双摆耦合效应）',
                                   '高速转盘弹道轨迹仪（偏转位移测量）', '微颗粒科氏力分离器（旋流分选机制）',
                                   '地球自转偏向模拟台（纬度效应验证）'],
            "傅科摆（地球自转演示）": ['真空阻尼傅科摆（空气阻力消除）', '激光路径记录傅科摆（光斑轨迹可视化）',
                                     '南北半球对比傅科摆（偏转方向演示）', '微型电磁驱动傅科摆（教室教学演示）',
                                     '高纬度傅科摆校准仪（摆平面转速计算）'],
            "潮汐力模拟仪": ['双星系统潮汐撕裂模拟器（引力梯度效应）', '月球-地球潮汐形变仪（弹性体变形观测）',
                             '引力波探测潮汐校准仪（空间拉伸模拟）', '流体潮汐共振演示仪（港口共振灾害）',
                             '微重力潮汐效应仪（空间站流体行为）'],
            "重力加速度测定仪（自由落体法）": ['真空落管重力仪（空气阻力消除）', '激光干涉自由落体仪（μm级位移精度）',
                                             '磁悬浮初速补偿仪（零初速释放）', '月球重力模拟落体仪（1.62ms²环境）',
                                             '多光电门同步计时仪（分段加速度分析）'],
            "阿特伍德机（匀加速运动）": ['数字光电计时阿特伍德机（自动误差修正）', '变质量滑轮系统（质量连续调节）',
                                       '气垫导轨集成阿特伍德机（摩擦消除）', '向心力-匀加速耦合演示仪（复合运动）',
                                       '智能反馈控制阿特伍德机（恒加速度维持）'],
            "能量转换验证装置": ['电磁阻尼动能转化仪（涡流热效应测量）', '重力势能-电能转换器（发电机效率分析）',
                                 '非弹性碰撞热能测定仪（红外温度记录）', '弹簧振子能量耗散仪（阻尼定量分析）',
                                 '太阳能-机械能转换台（光压驱动演示）'],
            "水锤效应实验仪": ['压力波高速采集仪（1ms压力瞬变记录）', '阀门快关水锤模拟器（管道冲击力测量）',
                               '气液两相水锤实验台（空化效应耦合）', '弹性管水锤衰减仪（材料减振效果）',
                               '核电站管道水锤安全仪（防爆阀测试）'],
            "流体阻力测试管": ['层流-湍流转捩观测管（染色液流可视化）', '非牛顿流体阻力管（剪切稀化效应）',
                               '微结构减阻测试管（鲨鱼皮仿生表面）', '高温气体阻力测试管（1000℃耐热材料）',
                               '变截面文丘里阻力仪（局部阻力系数）'],
            "泊肃叶定律实验装置": ['纳米通道泊肃叶流仪（微尺度效应验证）', '血液流变泊肃叶仪（非牛顿流体修正）',
                                   '恒压差自动调节装置（流量精准控制）', '微流量激光测速仪（层流剖面测量）',
                                   '粘温特性泊肃叶管（温度-粘度关联）'],
            "毛细管粘度计": ['高压毛细管流变仪（100MPa剪切速率）', '微量样品毛细管粘度计（生物试剂检测）',
                             '透明导电毛细管仪（电场调控粘度）', '高温玻璃熔体毛细管仪（软化点测定）',
                             '自动清洗防堵毛细管（工业在线监测）'],
            "流变仪（非牛顿流体）": ['振荡剪切流变仪（线性粘弹性区测量）', '拉伸流变仪（高分子链取向分析）',
                                   '颗粒悬浮流变仪（浓度-粘度关系）', '触变性流体恢复仪（结构破坏与重建）',
                                   '电流变液可控流变仪（电场强度调节）'],
            "颗粒力学剪切盒": ['三轴颗粒剪切仪（围压控制散体摩擦）', '微重力颗粒剪切仪（空间颗粒行为）',
                               '仿生颗粒流动盒（动物洞穴土体稳定性）', '高温颗粒烧结剪切仪（颗粒桥接效应）',
                               '透明剪切盒配DIC系统（颗粒位移全场测量）'],
            "微力学探针（纳米压痕）": ['原位电镜纳米压痕仪（实时微观变形观测）', '高温纳米压痕仪（800℃微区硬度）',
                                     '生物细胞微压痕探针（活体刚度测量）', '动态模量测量探针（振荡载荷粘弹性）',
                                     '多针尖阵列并行测试仪（高通量筛选）'],
            "原子力显微镜（AFM，微观力学）": ['流体环境AFM（液相分子力测量）', '高速AFM（生物分子动态过程观测）',
                                           '低温AFM（量子材料拓扑态分析）', '压电力显微镜（铁电畴翻转力学耦合）',
                                           '磁力显微镜-原子力联用（磁机械效应）'],
            "微划痕测试仪（薄膜附着力）": ['声发射划痕检测仪（膜基剥离事件识别）', '变温度微划痕仪（热应力影响分析）',
                                         '多层膜界面划痕仪（层间结合力评估）', '生物涂层划痕仪（植入材料界面强度）',
                                         '纳米压痕-划痕联用仪（硬度-附着力同步）'],
            "生物材料微力学测试平台": ['细胞牵张培养力学仪（周期性拉伸刺激）', '组织穿刺力学模拟仪（手术针阻力测量）',
                                       '血管脉动流生物反应器（血流剪切力模拟）', '骨微裂纹扩展观测仪（疲劳载荷下微观损伤）',
                                       '仿生水凝胶压缩仪（溶胀应力耦合分析）']
        },  # 500

}
    for Secondary_directories in search_arr_s:
        print(f"当前字典：{Secondary_directories}")
        for search_arr_name in search_arr_s[Secondary_directories]:
            print(f"当前数组：{search_arr_name}")
            for search in search_arr_s[Secondary_directories][search_arr_name]:
                print(f"词条:{search}")

                # 爬取的网页URL
                target_url = f"https://cn.bing.com/images/search?q={search}"

                # 调用函数开始爬取（可自定义保存目录和最大下载数）
                download_images_from_url(target_url, save_dir=rf"{Secondary_directories}\{search_arr_name}\{search}", max_images=5000, delay=0.5,use_selenium=True)